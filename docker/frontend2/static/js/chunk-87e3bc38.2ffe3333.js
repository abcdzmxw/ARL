(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-87e3bc38"],{e382:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app-container calendar-list-container"},[s("basic-container",[s("avue-crud",{ref:"crud",attrs:{option:e.tableOption,data:e.list,page:e.page,search:e.search,"table-loading":e.listLoading,"before-open":e.beforeOpen,permission:e.permissionList},on:{"update:page":function(t){e.page=t},"update:search":function(t){e.search=t},"on-load":e.getPage,"search-change":e.searchChange,"refresh-change":e.refreshChange,"row-update":e.handleUpdate,"row-save":e.handleSave,"row-del":e.handleDel},scopedSlots:e._u([{key:"menu",fn:function(t){var a=t.row;return[s("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-user"},on:{click:function(t){return e.showDialog(a,"assign")}}},[e._v("分配角色")])]}}]),model:{value:e.form,callback:function(t){e.form=t},expression:"form"}})],1),s("el-dialog",{staticClass:"avue-dialog avue-dialog--top",attrs:{size:"small",title:e.mDialog.title,visible:e.mDialog.visible,width:e.mDialog.width,destroyOnClose:""},on:{"update:visible":function(t){return e.$set(e.mDialog,"visible",t)},opened:e.beforeOpen2}},[s("div",["assign"==e.mDialog.sign?[s("avue-form",{ref:"assign",attrs:{option:e.assignOption},on:{submit:e.handleSubmit_assign},model:{value:e.assignForm,callback:function(t){e.assignForm=t},expression:"assignForm"}})]:e._e()],2),e.mDialog.hasFoot?s("div",{staticClass:"avue-dialog__footer"},[s("el-button",{attrs:{size:"small"},on:{click:function(t){e.mDialog.visible=!1}}},[e._v("取 消")]),s("el-button",{attrs:{size:"small",type:"primary"}},[e._v("确 定")])],1):e._e()])],1)},n=[],i=s("5530"),o=s("c7eb"),r=s("1da1"),l=(s("d3b7"),s("c24f")),c=s("fe15"),g=s("61f7"),u=function(e,t,s){Object(g["d"])(t)?s():s(new Error("手机号码格式不对"))},h={dialogDrag:!1,dialogHeight:560,labelWidth:"130",border:!0,index:!0,indexLabel:"序号",stripe:!0,menuAlign:"center",menuWidth:360,align:"center",viewBtn:!1,excelBtn:!1,addBtn:!0,delBtn:!0,editBtn:!0,columnBtn:!1,printBtn:!1,menuType:"text",searchMenuSpan:6,searchShow:!0,searchIndex:3,searchIcon:!0,labelSuffix:" ",column:[{label:"姓名",prop:"name",span:12,search:!0,rules:[{required:!0,message:"请填写",trigger:"blur"}]},{label:"账户",prop:"username",span:12,search:!0,rules:[{required:!0,message:"请填写",trigger:"blur"}]},{label:"密码",prop:"password",span:12,hide:!0,rules:[{required:!0,message:"请填写",trigger:"blur"}]},{label:"电话",prop:"phone",span:12,search:!0,maxlength:11,rules:[{required:!1,message:"请输入手机号"},{validator:u,trigger:"blur"}]},{label:"邮箱",prop:"email",span:12,search:!0,rules:[{required:!1,message:"请填写",trigger:"blur"}]}]},d={name:"MenuList",components:{},data:function(){return{search:{},tableOption:h,page:{total:0,currentPage:1,pageSize:10,ascs:[],descs:[]},paramsSearch:{},list:[],listLoading:!1,form:{},firstLevelMenuList:[],mDialog:{title:"提示",visible:!1,width:"40%",hasFoot:!0,sign:""},assignOption:{labelWidth:120,column:[{label:"角色",type:"select",prop:"role_id",slot:!0,span:24,rules:[{required:!0,message:"请选择",trigger:"blur"}]}]},assignForm:{},roleList:[],curr_user_id:""}},computed:{permissionList:function(){return{}}},watch:{},created:function(){this.getRoleList()},methods:{getRoleList:function(){var e=this;return Object(r["a"])(Object(o["a"])().mark((function t(){return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("1"),t.next=3,Object(c["d"])().then((function(t){var s=t.data;e.roleList=s,e.assignOption.column[0].dicData=s,console.log("roleList",t)}));case 3:case"end":return t.stop()}}),t)})))()},getPage:function(e,t){var s=this;this.listLoading=!0,Object(l["f"])(Object.assign({page:e.currentPage,size:e.pageSize,descs:this.page.descs,ascs:this.page.ascs},t)).then((function(e){var t=e.data;s.list=t.items,s.page.total=t.total,s.page.currentPage=t.page,s.page.pageSize=t.size,s.listLoading=!1})).catch((function(){s.listLoading=!1}))},refreshChange:function(e){console.log("refreshChange",e),this.getPage(this.page)},searchChange:function(e,t){console.log("searchChange",e),this.page.currentPage=1,this.getPage(this.page,this.filterForm(e)),t()},beforeOpen:function(e,t){e()},beforeOpen2:function(){var e=this;Object(c["e"])().then((function(t){console.log("roleObj",t),e.assignForm.role_id=t.data[0].id}))},handleDel:function(e,t){var s=this;this.$confirm("是否确认删除?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={id:e.id};Object(l["c"])(t).then((function(e){200==e.code?(s.$message({showClose:!0,message:e.message,type:"success"}),s.getPage(s.page)):s.$message({showClose:!0,message:e.message,type:"error"})}))})).catch((function(e){console.log("err",e)}))},handleSave:function(e,t,s){var a=this,n=this,o=Object(i["a"])({},e);Object(l["a"])(o).then((function(e){200==e.code?(n.$message({showClose:!0,message:e.message,type:"success"}),n.getPage(a.page)):(n.$message({showClose:!0,message:e.message,type:"error"}),n.getPage(a.page))})).catch((function(e){console.log("err",e)})).finally((function(){t(),s()}))},handleUpdate:function(e,t,s,a){var n=this,o=this,r=Object(i["a"])({},e);Object(l["i"])(r).then((function(e){200==e.code?(o.$message({showClose:!0,message:e.message,type:"success"}),o.getPage(n.page)):(o.$message({showClose:!0,message:e.message,type:"error"}),o.getPage(n.page),o.getFirstLevelMenuList())})).catch((function(e){console.log("err",e)})).finally((function(){s(),a()}))},showDialog:function(e,t){console.log("show",e,t),this.mDialog.sign=t,this.mDialog.visible=!0,"assign"==t&&(this.mDialog.hasFoot=!1,this.mDialog.title="分配角色",this.mDialog.width="420px",this.curr_user_id=e.user_id)},handleSubmit_assign:function(e,t){var s=this;console.log("handleSubmit_assign",e),Object(l["b"])(this.curr_user_id,e).then((function(e){s.$message({showClose:!0,message:e.message,type:"success"}),s.closeDialog()})).catch((function(e){s.$message({showClose:!0,message:res.message,type:"error"})})).finally((function(){t()}))},closeDialog:function(){this.mDialog.visible=!1}}},p=d,m=s("2877"),f=Object(m["a"])(p,a,n,!1,null,null,null);t["default"]=f.exports},fe15:function(e,t,s){"use strict";s.d(t,"c",(function(){return n})),s.d(t,"e",(function(){return i})),s.d(t,"d",(function(){return o})),s.d(t,"a",(function(){return r})),s.d(t,"f",(function(){return l})),s.d(t,"b",(function(){return c}));var a=s("b775");function n(e){return Object(a["a"])({url:"/role/pageList",method:"get",params:e})}function i(e){return Object(a["a"])({url:"/role/assignRoleList",method:"get",params:e})}function o(){return Object(a["a"])({url:"/role/list",method:"get"})}function r(e){return Object(a["a"])({url:"/role/",method:"post",data:e})}function l(e){return Object(a["a"])({url:"/role/",method:"patch",data:e})}function c(e){return Object(a["a"])({url:"/role/",method:"delete",data:e})}}}]);